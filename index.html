<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <script src="prayers.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
</head>

<body>
    <div class="app-container">
        <aside class="side-menu">
            <div class="logo">SB</div>
            <nav class="nav-menu">
                <button class="nav-btn active" onclick="showPage('home', event)"><i class="fas fa-home"></i></button>
                <button class="nav-btn" onclick="showPage('planner', event)"><i class="fas fa-calendar"></i></button>
                <button class="nav-btn" onclick="showPage('prayers',event)"><i class="fas fa-pray"></i></button>
                <button class="nav-btn"><i class="fas fa-trophy"></i></button>
                <div class="xp-status"><span>â­</span><span id="xp-count">0</span></div>
            </nav>
        </aside>
        <div class="content-area">
            <section id="home" class="page-section" dir="rtl">
                <div>
                    <h1>Study<span>Buddy</span></h1>
                    <p>Your Sweet Partner In Studying.</p>
                </div>
                <div class="welcome-header">
                    <h1 id="greeting">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¨Ø·Ù„! âš¡</h1>
                    <p class="subtitle">Ø¬Ø§Ù‡Ø² Ù„Ø¥Ù†Ø¬Ø§Ø² Ù…Ù‡Ø§Ù…Ùƒ Ø§Ù„ÙŠÙˆÙ…ØŸ</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-check-circle"></i>
                        <div class="stat-info">
                            <span id="tasks-done">
                                0
                            </span>
                            <p>Ù…Ù‡Ø§Ù… Ù…ÙƒØªÙ…Ù„Ø©</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-fire"></i>
                        <div class="stat-info">
                            <span id="current-xp-home">0</span>
                            <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ XP</p>
                        </div>
                    </div>
                </div>

                <div class="main-progress-circle">
                    <svg width="200" height="200">
                        <circle class="bg" cx="100" cy="100" r="90"></circle>
                        <circle class="progress" id="progress-circle" cx="100" cy="100" r="90"></circle>
                    </svg>
                    <div class="progress-text">
                        <span id="progress-text">0%</span>
                        <p>Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…</p>
                    </div>
                </div>

                <div class="quote-container">
                    <p id="daily-quote">
                        "Ø§Ù„Ù†Ø¬Ø§Ø­ Ù‡Ùˆ Ù…Ø¬Ù…ÙˆØ¹ Ù…Ø­Ø§ÙˆÙ„Ø§Øª ØµØºÙŠØ±Ø© ØªØªÙƒØ±Ø± ÙƒÙ„ ÙŠÙˆÙ…."
                    </p>
                </div>
            </section>

            <section id="planner" class="page-section" style="display: none">
                <h2>Daily Planner</h2>
                <div class="planner-container">
                    <div class="input-group">
                        <input type="text" id="taskInput" placeholder="Add a new task ...">
                        <select id="taskCategory" dir="rtl">
                            <option value="Study">Ù…Ø°Ø§ÙƒØ±Ø©</option>
                            <option value="HomeWork">ÙˆØ§Ø¬Ø¨</option>
                            <option value="Review">Ù…Ø±Ø§Ø¬Ø¹Ø©</option>
                            <option value="Exam">Ø§Ù…ØªØ­Ø§Ù†</option>
                            <option value="Applications">ØªØ·Ø¨ÙŠÙ‚ Ùˆ Ø­Ù„</option>
                        </select>

                        <select id="taskPriority" dir="rtl">
                            <option value="low">Ø¹Ø§Ø¯ÙŠ ğŸŸ¢</option>
                            <option value="medium">Ù…ØªÙˆØ³Ø· ğŸŸ¡</option>
                            <option value="high">Ø¹Ø§Ø¬Ù„ ğŸ”´</option>
                        </select>
                        <button id="addBtn"><i class="fas fa-plus"></i></button>
                    </div>

                    <div id="pomodoro-overlay" class="timer-overlay" style="display:none">
                        <div class="timer-card">
                            <h2 id="timer-task-name">Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h2>

                            <div id="time-selector-area">
                                <p>Focus Time :</p>
                                <input type="range" id="time-slider" min="5" max="90" value="25" step="5">
                                <span id="selected-minutes">25 minutes</span>
                            </div>

                            <div class="timer-display" id="timer-countdown">25:00</div>
                            <div class="timer-controls">
                                <button id="pause-resume-btn" class="timer-btn primary">Pause</button>
                                <button id="cancel-timer-btn" class="timer-btn danger">Cancel</button>
                            </div>
                            <p class="timer-quote">"Ø±ÙƒØ² ÙŠØ§ ÙˆØ­Ø´ØŒ Ø§Ù„Ø¹Ø§Ù„Ù… Ø¨ÙŠÙ†ØªØ¸Ø±Ùƒ! ğŸš€"</p>
                        </div>
                    </div>
                    <ul id="taskList"></ul>
                </div>
            </section>

            <section id="prayers" class="page-section" style="display:none">
                <h2>Prayer Times</h2>
                <div id="prayer-section" style="display: none">Loading...</div>
                <div id="prayerlist">
                    <thead>
                        <th>Ø§Ù„Ø§Ø°Ø§Ù†</th>
                        <th>Ø§Ù„ÙˆÙ‚Øª</th>
                    </thead>
                    <div class="elSalah-quotes">
                        <p>
                            Ø§ÙˆÙ„ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù†Ø¬Ø§Ø­ Ù‡ÙŠ Ø§Ù„ØµÙ„Ø§Ø©
                        </p>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <script>
        function showPage(pageId, event) {
            const sections = document.querySelectorAll(".page-section");
            sections.forEach(section => {
                section.style.display = "none"
            });

            const targetSection = document.getElementById(pageId);
            if (targetSection) {
                targetSection.style.display = "block";
            }

            document.querySelectorAll(".nav-btn").forEach(buttons => {
                buttons.classList.remove("active");
            })
            event.currentTarget.classList.add("active")

            localStorage.setItem("lastActivePage", pageId);


            // updating the circle

            const circle = document.getElementById("progress-circle");
            if (pageId === 'home' && circle) {
                // updatehomeStats();
                const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
                const completed = tasks.filter(t => String(t.checked) === "true").length;
                const currentPercent = tasks.length > 0 ? Math.round((completed / tasks.length) * 100) : 0;

                const lastSeenPercent = localStorage.getItem("lastSeenPercent");

                if (lastSeenPercent === null || currentPercent != lastSeenPercent) {
                    circle.classList.remove("animate-circle");
                    circle.style.transition = "none";
                    circle.style.strokeDashoffset = "565";

                    void circle.offsetWidth;

                    setTimeout(() => {
                        circle.style.transition = "stroke-dashoffset 1.5s cubic-bezier(0.4, 0, 0.2, 1)";
                        const targetOffset = 565 - (565 * currentPercent) / 100;
                        circle.style.strokeDashoffset = targetOffset;
                        updatehomeStats();
                        localStorage.setItem("lastSeenPercent", currentPercent);
                    }, 50);
                } else {
                    circle.classList.remove("animate-circle")
                    updatehomeStats(true);
                }
            } else {
                updatehomeStats(true);
            }
        }
    </script>
</body>

</html>