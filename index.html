<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
    <script src="prayers.js" defer></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>

</head>

<body>
    <div class="app-container">
        <aside class="side-menu">
            <div class="logo">SB</div>
            <nav class="nav-menu">
                <button class="nav-btn active" onclick="showPage('home', event)"><i class="fas fa-home"></i></button>
                <button class="nav-btn" onclick="showPage('planner', event)"><i class="fas fa-calendar"></i></button>
                <button class="nav-btn" onclick="showPage('prayers',event)"><i class="fas fa-pray"></i></button>
                <button class="nav-btn" onclick="showPage('leaderboard')"><i class="fas fa-trophy"></i></button>
                <div class="xp-status"><span>โญ</span><span id="xp-count">0</span></div>
            </nav>
        </aside>
        <div class="content-area">
            <section id="home" class="page-section" dir="rtl">
                <div>
                    <h1>Study<span>Buddy</span></h1>
                    <p>Your Sweet Partner In Studying.</p>
                </div>
                <div class="welcome-header">
                    <h1 id="greeting">ุฃููุงู ุจู ูุง ุจุทู! โก</h1>
                    <div id="user-rank"
                        style="color: #6366f1; font-weight: bold; font-size: 1.1rem; margin-bottom: 15px;"></div>
                    <p class="subtitle">ุฌุงูุฒ ูุฅูุฌุงุฒ ููุงูู ุงููููุ</p>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-check-circle"></i>
                        <div class="stat-info">
                            <span id="tasks-done">
                                0
                            </span>
                            <p>ููุงู ููุชููุฉ</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-fire"></i>
                        <div class="stat-info">
                            <span id="current-xp-home">0</span>
                            <p>ุฅุฌูุงูู ุงู XP</p>
                        </div>
                    </div>
                </div>

                <div class="main-progress-circle">
                    <svg width="200" height="200">
                        <circle class="bg" cx="100" cy="100" r="90"></circle>
                        <circle class="progress" id="progress-circle" cx="100" cy="100" r="90"></circle>
                    </svg>
                    <div class="progress-text">
                        <span id="progress-text">0%</span>
                        <p>ุฅูุฌุงุฒ ุงูููู</p>
                    </div>
                </div>

                <div class="quote-container">
                    <p id="daily-quote">
                        "ุงููุฌุงุญ ูู ูุฌููุน ูุญุงููุงุช ุตุบูุฑุฉ ุชุชูุฑุฑ ูู ููู."
                    </p>
                </div>
            </section>

            <section id="planner" class="page-section" style="display: none">
                <h2>Daily Planner</h2>
                <div class="planner-container">
                    <div class="input-group">
                        <input type="text" id="taskInput" placeholder="Add a new task ...">
                        <select id="taskCategory" dir="rtl">
                            <option value="Study">ูุฐุงูุฑุฉ</option>
                            <option value="HomeWork">ูุงุฌุจ</option>
                            <option value="Review">ูุฑุงุฌุนุฉ</option>
                            <option value="Exam">ุงูุชุญุงู</option>
                            <option value="Applications">ุชุทุจูู ู ุญู</option>
                        </select>

                        <select id="taskPriority" dir="rtl">
                            <option value="low">ุนุงุฏู ๐ข</option>
                            <option value="medium">ูุชูุณุท ๐ก</option>
                            <option value="high">ุนุงุฌู ๐ด</option>
                        </select>
                        <button id="addBtn"><i class="fas fa-plus"></i></button>
                    </div>

                    <div id="pomodoro-overlay" class="timer-overlay" style="display:none">
                        <div class="timer-card">
                            <h2 id="timer-task-name">ุงุณู ุงููููุฉ ุงูุญุงููุฉ</h2>

                            <div id="time-selector-area">
                                <p>Focus Time :</p>
                                <input type="range" id="time-slider" min="5" max="90" value="25" step="5">
                                <span id="selected-minutes">25 minutes</span>
                            </div>

                            <div class="timer-display" id="timer-countdown">25:00</div>
                            <div class="timer-controls">
                                <button id="pause-resume-btn" class="timer-btn primary">Pause</button>
                                <button id="cancel-timer-btn" class="timer-btn danger">Cancel</button>
                            </div>
                            <p class="timer-quote">"ุฑูุฒ ูุง ูุญุดุ ุงูุนุงูู ุจููุชุธุฑู! ๐"</p>
                        </div>
                    </div>
                    <ul id="taskList"></ul>
                </div>
            </section>

            <section id="prayers" class="page-section" style="display:none">
                <h2>Prayer Times</h2>
                <div id="prayer-section" style="display: none">Loading...</div>
                <div id="prayerlist">
                    <thead>
                        <th>ุงูุงุฐุงู</th>
                        <th>ุงูููุช</th>
                    </thead>
                </div>
                <div class="elSalah-quotes">
                    <p dir="rtl">
                        <q>ุฃุฑูุญูุง ุจูุง ูุง ุจูุงู โค๏ธ</q>
                    </p>
                </div>
                <div class="remembrance-section" dir="rtl">
                    <div class="remembrance-tabs">
                        <button class="tab-btn " onclick="showRemembrance('success', event)">ุฃุฏุนูุฉ
                            ุงูุชูููู</button>
                        <button class="tab-btn" onclick="showRemembrance('morning', event)">ุฃุฐูุงุฑ ุงูุตุจุงุญ</button>
                        <button class="tab-btn" onclick="showRemembrance('evening', event)">ุฃุฐูุงุฑ ุงููุณุงุก</button>
                    </div>

                    <div id="remembrance-container" class="cards-grid">
                        <p class="dua-text">"ุงูููู ูุง ุณูู ุฅูุง ูุง ุฌุนูุชู ุณููุงูุ ูุฃูุช ุชุฌุนู ุงูุญุฒู ุฅุฐุง ุดุฆุช ุณููุงู"</p>
                    </div>
                </div>
            </section>

            <section id="leaderboard" class="page-section" style="display:none">
                <div class="leaderboard-container">
                    <h2>LeaderBoard</h2>
                    <p>Coming Soon...</p>
                </div>
            </section>

        </div>
    </div>

    <div id="prayer-overlay"
        style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(26, 12, 75, 0.98); z-index:9999; flex-direction:column; align-items:center; justify-content:center; color:white; text-align:center; font-family: 'Cairo', sans-serif;">
        <h2 style="margin-bottom: 20px;">ุญุงู ููุช ุงูุตูุงุฉ ุงูุขู ๐</h2>
        <p style="font-size: 1.2rem;">ูุงู ุตูู ุงููู ุนููู ูุณูู: "ุฃูู ูุง ูุญุงุณุจ ุจู ุงูุนุจุฏ ููู ุงูููุงูุฉ ุงูุตูุงุฉ"</p>

        <div style="font-size: 3rem; font-weight: bold; margin: 20px 0; color: #f1faee;" id="return-timer">15:00</div>

        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; max-width: 80%;">
            <p id="prayer-tip">ุงุณุชุบู ูุฐู ุงูุฏูุงุฆู ูู ุตูุงุฉ ุงูุณูุฉ ูุงูุฃุฐูุงุฑ</p>
        </div>
    </div>

    <div id="quran-overlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(10, 25, 47, 0.98); z-index:10000; flex-direction:column; align-items:center; justify-content:center; color:white; text-align:center; font-family: 'Cairo', sans-serif; padding: 20px;">
    <div style="background: #1a0c4b; padding: 30px; border-radius: 20px; border: 2px solid #6366f1; max-width: 500px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.5);">
        <h2 style="color: #6366f1; margin-bottom: 15px;">ูุฑุฏ ุงููุฑุขู ุงููุฑูู ๐</h2>
        <p style="font-size: 1.1rem; line-height: 1.6; margin-bottom: 20px;">
            "ููุฑู ููููู ูุจุฑูุฉู ูู ููุชู.." <br>
            ูุจู ุฃู ุชุจุฏุฃ ุฑุญูุฉ ุงูุนููุ ูู ูุฑุฃุช ูุฑุฏู ุงูููููุ
        </p>
        
        <input type="text" id="quranConfirm" placeholder="ูุงุฐุง ูุฑุฃุช ุงููููุ (ูุซูุงู: ุณูุฑุฉ ุงูููู)" 
            style="width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #457b9d; background: #0f172a; color: white; margin-bottom: 20px; text-align: center; font-family: 'Cairo';">
        
        <button onclick="verifyQuran()" 
            style="background: #6366f1; color: white; border: none; padding: 12px 30px; border-radius: 10px; font-weight: bold; cursor: pointer; width: 100%; transition: 0.3s;">
            ุชูุช ุงููุฑุงุกุฉ ุจุญูุฏ ุงููู
        </button>
        
        <p style="font-size: 0.8rem; color: #94a3b8; margin-top: 15px;">ุณูุชู ูุชุญ ุงููููุน ููุฑ ุฅุฏุฎุงู ูุฑุฏู</p>
    </div>
</div>

    <script>
        function showPage(pageId, event) {
            const sections = document.querySelectorAll(".page-section");
            sections.forEach(section => {
                section.style.display = "none"
            });

            const targetSection = document.getElementById(pageId);
            if (targetSection) {
                targetSection.style.display = "block";
            }

            document.querySelectorAll(".nav-btn").forEach(buttons => {
                buttons.classList.remove("active");
            })
            event.currentTarget.classList.add("active")

            localStorage.setItem("lastActivePage", pageId);


            // updating the circle

            const circle = document.getElementById("progress-circle");
            if (pageId === 'home' && circle) {
                // updatehomeStats();
                const tasks = JSON.parse(localStorage.getItem("tasks")) || [];
                const completed = tasks.filter(t => String(t.checked) === "true").length;
                const currentPercent = tasks.length > 0 ? Math.round((completed / tasks.length) * 100) : 0;

                const lastSeenPercent = localStorage.getItem("lastSeenPercent");

                if (lastSeenPercent === null || currentPercent != lastSeenPercent) {
                    circle.classList.remove("animate-circle");
                    circle.style.transition = "none";
                    circle.style.strokeDashoffset = "565";

                    void circle.offsetWidth;

                    setTimeout(() => {
                        circle.style.transition = "stroke-dashoffset 1.5s cubic-bezier(0.4, 0, 0.2, 1)";
                        const targetOffset = 565 - (565 * currentPercent) / 100;
                        circle.style.strokeDashoffset = targetOffset;
                        updatehomeStats();
                        localStorage.setItem("lastSeenPercent", currentPercent);
                    }, 50);
                } else {
                    circle.classList.remove("animate-circle")
                    updatehomeStats(true);
                }
            } else {
                updatehomeStats(true);
            }
        }
    </script>
</body>

</html>